{"version":3,"sources":["webpack:///./src/pages/news.js","webpack:///./src/utils/dao.js"],"names":["News","useState","response","setResponse","posts","setPosts","next","setNext","POST_PARAMS","data","content","limit","getPosts","fetch","getPostsUrl","then","console","log","useEffect","length","_links","total_posts","href","pageContext","offsetHero","map","post","key","photos","src","alt_sizes","url","alt","summary","tags","to","id_string","slug","onClick","API_KEY","params","api_key","POST_URL","Object","keys","join","encodeParams","endpoint","options","method","headers","window","ok","status","statusText","json","error","message","Promise","reject","catch"],"mappings":"2KAuEeA,UA9DF,WAAO,IAAD,EACeC,mBAAS,IAAlCC,EADU,KACAC,EADA,OAESF,mBAAS,IAA5BG,EAFU,KAEHC,EAFG,OAGOJ,mBAAS,IAA1BK,EAHU,KAGJC,EAHI,KAMXC,GADUC,EAAKC,QACD,CAClBC,MAAO,IAGHC,EAAW,SAACN,GAChBO,YAAMC,YAAYN,EAAaF,IAAOS,MAAK,SAACN,GAC1CO,QAAQC,IAAIR,EAAKP,UACjBC,EAAYM,EAAKP,cAsBrB,OAlBAgB,qBAAU,WACRN,MACC,IAEHM,qBAAU,WACJhB,GAAYA,EAASE,OAASF,EAASE,MAAMe,OAAS,GACxDd,EAAS,GAAD,mBAAKD,GAAL,YAAeF,EAASE,WAEjC,CAACF,IAEJgB,qBAAU,WACJhB,EAASkB,QAAUhB,EAAMe,OAASjB,EAASmB,YAC7Cd,EAAQL,EAASkB,OAAOd,KAAKgB,MAE7Bf,EAAQ,MAET,CAACH,IAGF,kBAAC,IAAD,CAAQmB,YAAad,GACnB,kBAAC,IAAD,CAAWe,YAAU,GAClBpB,EAAMqB,KAAI,SAACC,EAAMC,GAAP,OACT,yBAAKA,IAAKA,GACPD,EAAKE,QACJ,yBAAKC,IAAKH,EAAKE,OAAO,GAAGE,UAAU,GAAGC,IAAKC,IAAKN,EAAKO,UAEtDP,EAAKQ,MAAS,4BAAKR,EAAKQ,KAAK,IAC9B,6BAAMR,EAAKO,SACX,kBAAC,IAAD,CAAME,GAAE,SAAWT,EAAKU,UAAhB,IAA6BV,EAAKW,MAA1C,iBAIH/B,GACC,4BACEgC,QAAS,WACP1B,EAASN,KAFb,iB,kCC3DV,wEACMiC,EAAU,qDAQHzB,EAAc,SAAC0B,EAAalC,GAGvC,YAHgD,IAAtBkC,MAAS,IACnCA,EAAOC,QAAUF,EAEVjC,EAAI,yBACoBA,EADpB,YACoCiC,EACtCG,gEAXiB,SAACF,GAC3B,YAD2C,IAAhBA,MAAS,IAC7BG,OAAOC,KAAKJ,GAClBf,KAAI,SAAAE,GAAG,OAAOA,EAAP,IAAca,EAAOb,MAC5BkB,KAAK,KAQeC,CAAaN,IAGvB3B,EAAQ,SAACkC,EAAeC,GAMnC,YADI,IALgBD,MAAW,SAK3B,IAL+BC,MAAU,CAC7CC,OAAQ,MACRC,QAAS,CACL,eAAgB,qCAGbC,OAAOtC,MAAMkC,EAAUC,GAC3BjC,MAAK,SAACb,GAAc,IAEjBkD,EAIElD,EAJFkD,GACAC,EAGEnD,EAHFmD,OACAC,EAEEpD,EAFFoD,WACAvB,EACE7B,EADF6B,IAGF,GAAIqB,EACF,OAAOlD,EAASqD,OAGlB,IAAMC,EAAQ,CACZC,QAAYJ,EAAL,KAAgBC,EAAhB,yBAAmDvB,EAC1D7B,WACAmD,SACAC,cAGF,OAAOI,QAAQC,OAAOH,MAEvBI,OAAM,SAACJ,GACN,OAAOE,QAAQC,OAAOH,Q","file":"component---src-pages-news-js-53a6040ae591fdfa8171.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { fetch, getPostsUrl } from '../utils/dao';\n\n// Components\nimport { Layout, Container, Link, } from '../components';\n\n// Data\nimport data from '../data/pages/news.json';\n\nconst News = () => {\n  const [response, setResponse] = useState({});\n  const [posts, setPosts] = useState([]);\n  const [next, setNext] = useState('');\n\n  const content = data.content;\n  const POST_PARAMS = {\n    limit: 1,\n  };\n\n  const getPosts = (next) => {\n    fetch(getPostsUrl(POST_PARAMS, next)).then((data) => {\n      console.log(data.response);\n      setResponse(data.response);\n    });\n  };\n\n  useEffect(() => {\n    getPosts();\n  }, []);\n\n  useEffect(() => {\n    if (response && response.posts && response.posts.length > 0) {\n      setPosts([...posts, ...response.posts]);\n    }\n  }, [response]);\n\n  useEffect(() => {\n    if (response._links && posts.length < response.total_posts) {\n      setNext(response._links.next.href);\n    } else {\n      setNext('');\n    }\n  }, [posts]);\n\n  return (\n    <Layout pageContext={data}>\n      <Container offsetHero>\n        {posts.map((post, key) => (\n          <div key={key}>\n            {post.photos && (\n              <img src={post.photos[0].alt_sizes[3].url} alt={post.summary} />\n            )}\n            {post.tags && (<h2>{post.tags[0]}</h2>)}\n            <div>{post.summary}</div>\n            <Link to={`/post/${post.id_string}/${post.slug}`}>Read More</Link>\n          </div>\n        ))}\n\n        {next && (\n          <button\n            onClick={() => {\n              getPosts(next);\n            }}>\n            Load More\n          </button>\n        )}\n      </Container>\n    </Layout>\n  );\n};\n\nexport default News;\n","const POST_URL = 'https://api.tumblr.com/v2/blog/aristowealth.tumblr.com/posts';\nconst API_KEY = 'a9rmrkt46nr8csi1Fkp9VarPafZws8ZQJZyitfTtDWcwB5GhHe';\n\nexport const encodeParams = (params = {}) => {\n  return Object.keys(params)\n  .map(key => `${key}=${params[key]}`)\n  .join('&');\n};\n\nexport const getPostsUrl = (params = {}, next) => {\n  params.api_key = API_KEY;\n\n  return next\n      ? `https://api.tumblr.com${next}&api_key=${API_KEY}`\n      : `${POST_URL}?${encodeParams(params)}`;\n};\n\nexport const fetch = (endpoint = '', options = {\n  method: 'GET',\n  headers: {\n      'Content-Type': 'application/json; charset=utf-8',\n  },\n}) => {\n  return window.fetch(endpoint, options)\n    .then((response) => {\n      const {\n        ok,\n        status,\n        statusText,\n        url,\n      } = response;\n\n      if (ok) {\n        return response.json();\n      }\n\n      const error = {\n        message: `${status}: ${statusText}, failure for call to ${url}`,\n        response,\n        status,\n        statusText,\n      };\n\n      return Promise.reject(error);\n    })\n    .catch((error) => {\n      return Promise.reject(error);\n    });\n}"],"sourceRoot":""}