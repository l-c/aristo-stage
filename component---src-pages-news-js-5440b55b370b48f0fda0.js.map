{"version":3,"sources":["webpack:///./src/pages/news.js","webpack:///./src/utils/dao.js"],"names":["News","useState","response","setResponse","posts","setPosts","next","setNext","POST_PARAMS","limit","getPosts","fetch","getPostsUrl","then","data","console","log","useEffect","length","_links","total_posts","href","pageContext","map","post","key","imagePath","photos","alt_sizes","url","title","tags","text","summary","variant","to","id_string","slug","type","onClick","API_KEY","params","api_key","POST_URL","Object","keys","join","encodeParams","endpoint","options","method","headers","window","ok","status","statusText","json","error","message","Promise","reject","catch"],"mappings":"2KA4EeA,UAnEF,WAAO,IAAD,EACeC,mBAAS,IAAlCC,EADU,KACAC,EADA,OAESF,mBAAS,IAA5BG,EAFU,KAEHC,EAFG,OAGOJ,mBAAS,IAA1BK,EAHU,KAGJC,EAHI,KAKXC,EAAc,CAClBC,MAAO,GAGHC,EAAW,SAACJ,GAChBK,YAAMC,YAAYJ,EAAaF,IAAOO,MAAK,SAACC,GAC1CC,QAAQC,IAAIF,EAAKZ,UACjBC,EAAYW,EAAKZ,cAsBrB,OAlBAe,qBAAU,WACRP,MACC,IAEHO,qBAAU,WACJf,GAAYA,EAASE,OAASF,EAASE,MAAMc,OAAS,GACxDb,EAAS,GAAD,mBAAKD,GAAL,YAAeF,EAASE,WAEjC,CAACF,IAEJe,qBAAU,WACJf,EAASiB,QAAUf,EAAMc,OAAShB,EAASkB,YAC7Cb,EAAQL,EAASiB,OAAOb,KAAKe,MAE7Bd,EAAQ,MAET,CAACH,IAGF,kBAAC,IAAD,CAAQkB,YAAaR,GACnB,kBAAC,IAAD,KACGV,EAAMmB,KAAI,SAACC,EAAMC,GAAP,OACT,kBAAC,IAAD,CACEA,IAAKA,EACLC,UAAWF,EAAKG,QAAUH,EAAKG,OAAO,GAAGC,UAAU,GAAGC,IACtDC,MAAON,EAAKO,MAAQP,EAAKO,KAAK,GAC9BC,KAAMR,EAAKS,SACX,6BACE,kBAAC,IAAD,CACEC,QAAQ,UACRC,GAAE,SAAWX,EAAKY,UAAhB,IAA6BZ,EAAKa,MAFtC,kBASL/B,GACC,kBAAC,IAAD,CACEgC,KAAK,SACLC,QAAS,WACP7B,EAASJ,KAHb,iB,kCC/DV,wEACMkC,EAAU,qDAQH5B,EAAc,SAAC6B,EAAanC,GAGvC,YAHgD,IAAtBmC,MAAS,IACnCA,EAAOC,QAAUF,EAEVlC,EAAI,yBACoBA,EADpB,YACoCkC,EACtCG,gEAXiB,SAACF,GAC3B,YAD2C,IAAhBA,MAAS,IAC7BG,OAAOC,KAAKJ,GAClBlB,KAAI,SAAAE,GAAG,OAAOA,EAAP,IAAcgB,EAAOhB,MAC5BqB,KAAK,KAQeC,CAAaN,IAGvB9B,EAAQ,SAACqC,EAAeC,GAMnC,YADI,IALgBD,MAAW,SAK3B,IAL+BC,MAAU,CAC7CC,OAAQ,MACRC,QAAS,CACL,eAAgB,qCAGbC,OAAOzC,MAAMqC,EAAUC,GAC3BpC,MAAK,SAACX,GAAc,IAEjBmD,EAIEnD,EAJFmD,GACAC,EAGEpD,EAHFoD,OACAC,EAEErD,EAFFqD,WACA1B,EACE3B,EADF2B,IAGF,GAAIwB,EACF,OAAOnD,EAASsD,OAGlB,IAAMC,EAAQ,CACZC,QAAYJ,EAAL,KAAgBC,EAAhB,yBAAmD1B,EAC1D3B,WACAoD,SACAC,cAGF,OAAOI,QAAQC,OAAOH,MAEvBI,OAAM,SAACJ,GACN,OAAOE,QAAQC,OAAOH,Q","file":"component---src-pages-news-js-5440b55b370b48f0fda0.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { fetch, getPostsUrl } from '../utils/dao';\n\n// Components\nimport { Layout, Container, Info, Button } from '../components';\n\n// Data\nimport data from '../data/pages/news.json';\n\nconst News = () => {\n  const [response, setResponse] = useState({});\n  const [posts, setPosts] = useState([]);\n  const [next, setNext] = useState('');\n\n  const POST_PARAMS = {\n    limit: 1,\n  };\n\n  const getPosts = (next) => {\n    fetch(getPostsUrl(POST_PARAMS, next)).then((data) => {\n      console.log(data.response);\n      setResponse(data.response);\n    });\n  };\n\n  useEffect(() => {\n    getPosts();\n  }, []);\n\n  useEffect(() => {\n    if (response && response.posts && response.posts.length > 0) {\n      setPosts([...posts, ...response.posts]);\n    }\n  }, [response]);\n\n  useEffect(() => {\n    if (response._links && posts.length < response.total_posts) {\n      setNext(response._links.next.href);\n    } else {\n      setNext('');\n    }\n  }, [posts]);\n\n  return (\n    <Layout pageContext={data}>\n      <Container>\n        {posts.map((post, key) => (\n          <Info\n            key={key}\n            imagePath={post.photos && post.photos[0].alt_sizes[3].url}\n            title={post.tags && post.tags[0]}\n            text={post.summary}>\n            <div>\n              <Button\n                variant=\"outline\"\n                to={`/post/${post.id_string}/${post.slug}`}>\n                Read More\n              </Button>\n            </div>\n          </Info>\n        ))}\n\n        {next && (\n          <Button\n            type=\"button\"\n            onClick={() => {\n              getPosts(next);\n            }}>\n            Load More\n          </Button>\n        )}\n      </Container>\n    </Layout>\n  );\n};\n\nexport default News;\n","const POST_URL = 'https://api.tumblr.com/v2/blog/aristowealth.tumblr.com/posts';\nconst API_KEY = 'a9rmrkt46nr8csi1Fkp9VarPafZws8ZQJZyitfTtDWcwB5GhHe';\n\nexport const encodeParams = (params = {}) => {\n  return Object.keys(params)\n  .map(key => `${key}=${params[key]}`)\n  .join('&');\n};\n\nexport const getPostsUrl = (params = {}, next) => {\n  params.api_key = API_KEY;\n\n  return next\n      ? `https://api.tumblr.com${next}&api_key=${API_KEY}`\n      : `${POST_URL}?${encodeParams(params)}`;\n};\n\nexport const fetch = (endpoint = '', options = {\n  method: 'GET',\n  headers: {\n      'Content-Type': 'application/json; charset=utf-8',\n  },\n}) => {\n  return window.fetch(endpoint, options)\n    .then((response) => {\n      const {\n        ok,\n        status,\n        statusText,\n        url,\n      } = response;\n\n      if (ok) {\n        return response.json();\n      }\n\n      const error = {\n        message: `${status}: ${statusText}, failure for call to ${url}`,\n        response,\n        status,\n        statusText,\n      };\n\n      return Promise.reject(error);\n    })\n    .catch((error) => {\n      return Promise.reject(error);\n    });\n}"],"sourceRoot":""}